<configs>
  <!-- 既存 AddHealth を一括削除 -->
  <remove
    xpath="//buff[@name='buffBurnt_Storm' or @name='buffDesert_Storm' or @name='buffSnow_Storm' or @name='buffWasteland_Storm']
           //effect_group[requirement[@operation='LTE'] and requirement[@operation='EQ']]/triggered_effect[@action='AddHealth' and @health='@$StormDamage']" />

  <!-- 焼け森 Burnt -->
  <!-- ダメージ: -11 => -6 ~ -1 -->
  <append xpath="//buff[@name='buffBurnt_Storm']//effect_group[requirement[@operation='LTE'] and requirement[@operation='EQ']]">
    <!-- 1) HPダメージの乱数を設定 -->
    <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="$StormDamage" operation="set" value="randomInt(-6,-1)" />
    <!-- 2) HPダメージの乱数をスタミナ用にコピー -->
    <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".StormStamina" operation="set" value="@$StormDamage" />
    <!-- 3) スタミナ用の乱数を2倍に変更 -->
    <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".StormStamina" operation="multiply" value="2" />
    <!-- 4) HPとスタミナに乱数を反映 -->
    <triggered_effect trigger="onSelfBuffUpdate" action="AddHealth" health="@$StormDamage" />
    <triggered_effect trigger="onSelfBuffUpdate" action="ModifyStats" stat="Stamina" operation="add" value="@.StormStamina" />
  </append>

  <!-- 砂漠 Desert -->
  <!-- ダメージ: -12 => -7 ~ -2 -->
  <append xpath="//buff[@name='buffDesert_Storm']//effect_group[requirement[@operation='LTE'] and requirement[@operation='EQ']]">
    <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="$StormDamage" operation="set" value="randomInt(-7,-2)" />
    <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".StormStamina" operation="set" value="@$StormDamage" />
    <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".StormStamina" operation="multiply" value="2" />
    <triggered_effect trigger="onSelfBuffUpdate" action="AddHealth" health="@$StormDamage" />
    <triggered_effect trigger="onSelfBuffUpdate" action="ModifyStats" stat="Stamina" operation="add" value="@.StormStamina" />
  </append>

  <!-- 雪原 Snow -->
  <!-- ダメージ: -13 => -8 ~ -3 -->
  <append xpath="//buff[@name='buffSnow_Storm']//effect_group[requirement[@operation='LTE'] and requirement[@operation='EQ']]">
    <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="$StormDamage" operation="set" value="randomInt(-8,-3)" />
    <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".StormStamina" operation="set" value="@$StormDamage" />
    <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".StormStamina" operation="multiply" value="2" />
    <triggered_effect trigger="onSelfBuffUpdate" action="AddHealth" health="@$StormDamage" />
    <triggered_effect trigger="onSelfBuffUpdate" action="ModifyStats" stat="Stamina" operation="add" value="@.StormStamina" />
  </append>

  <!-- 荒地 Wasteland -->
  <!-- ダメージ: -14 => -9 ~ -4 -->
  <append xpath="//buff[@name='buffWasteland_Storm']//effect_group[requirement[@operation='LTE'] and requirement[@operation='EQ']]">
    <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="$StormDamage" operation="set" value="randomInt(-9,-4)" />
    <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".StormStamina" operation="set" value="@$StormDamage" />
    <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".StormStamina" operation="multiply" value="2" />
    <triggered_effect trigger="onSelfBuffUpdate" action="AddHealth" health="@$StormDamage" />
    <triggered_effect trigger="onSelfBuffUpdate" action="ModifyStats" stat="Stamina" operation="add" value="@.StormStamina" />
  </append>

  <!-- 嵐 発生中のバフ -->
  <append xpath="//buff[@name='buffBurnt_Storm' or @name='buffDesert_Storm' or @name='buffSnow_Storm' or @name='buffWasteland_Storm']">
    <effect_group>
      <!-- 経験値 +100% (2倍) -->
      <passive_effect name="PlayerExpGain" operation="perc_add" value="1" tags="Kill" />
      <!-- ゲームステージ +100% (2倍) -->
      <passive_effect name="GameStage" operation="perc_add" value="1" />
      <!-- 略奪品ステージ +100% (2倍) -->
      <passive_effect name="LootStage" operation="perc_add" value="1" />
      <!-- 略奪品ドロップ確率 +400% (5倍) -->
      <passive_effect name="LootDropProb" operation="perc_add" value="4" />
      <!-- 略奪品量 +100% (2倍) -->
      <passive_effect name="LootQuantity" operation="perc_add" value="1" tags="ammo" />
      <passive_effect name="LootQuantity" operation="perc_add" value="1" tags="food" />
      <passive_effect name="LootQuantity" operation="perc_add" value="1" tags="medical" />
      <passive_effect name="LootQuantity" operation="perc_add" value="1" tags="dukes" />
    </effect_group>
  </append>
</configs>